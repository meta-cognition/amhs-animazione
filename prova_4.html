<html>
<head>
	
	<!-- Load plotly.js into the DOM -->
	<script src='https://cdn.plot.ly/plotly-latest.min.js'></script>
	<style>
html, body {
  height: 100%;
  margin: 0;
}

.full-height {
  height: 100%;
  background: yellow;
}
</style>
</head>

<body>
<div class="full-height" id='myDiv'><!-- Plotly chart will be drawn inside this DIV --></div>
<script>
	var tracePorti;
	var plotlyLayout;
	var plotlyData;
	
	Plotly.setPlotConfig({
		mapboxAccessToken: "pk.eyJ1IjoiZG9tcGFubm9uZSIsImEiOiJja2tra3JxNWsxdWllMzBwZWExOWsyZGZjIn0.XQopGOyonxeWiAMEs6TxOg"
	});
	
	Plotly.d3.csv('https://raw.githubusercontent.com/meta-cognition/amhs-animazione/main/csv/porti.csv', function(err, rows){
		
		function unpack(rows, key) {
			return rows.map(function(row) { return row[key]; });
		}
		
		tracePorti = {
			type: 'scattermapbox',
			mode: 'markers+text',
			ids: unpack(rows, 'abbreviazione'),
			text: unpack(rows, 'abbreviazione'),
			textposition: "top center",
			hovertext: unpack(rows, 'combinato'),
			lon: unpack(rows, 'longitudine'),
			lat: unpack(rows, 'latitudine'),
			marker: {
				color: "red",
				opacity: 1,
				size: 5,
			}
			/*name: 'NA Precipitation'*/
		};
	
	
		plotlyLayout = {
			dragmode: 'zoom',
			mapbox: {
				center: {
					lat: 55,
					lon: -150
				},
				domain: {
					x: [0, 1],
					y: [0, 1]
				},
				style: 'light',
				zoom: 3
			},
			margin: {
				r: 0,
				t: 0,
				b: 0,
				l: 0,
				pad: 0
			},
			showlegend: false,
			/********* di animazione_prova_originale.js *************/
			updatemenus: [{
				x: 0.1,
				y: 0,
				yanchor: "top",
				xanchor: "right",
				showactive: false,
				direction: "left",
				type: "buttons",
				pad: {"t": 87, "r": 10},
				buttons: [{
					method: "animate",
					args: [
						null, 
						{
							fromcurrent: true,
							transition: {
								duration: 200,
							},
							frame: {
								duration: 500
							}
						}
					],
					label: "Play"
					}, 
					{
					method: "animate",
					args: [
						[null],
						{
							mode: "immediate",
							transition: {
								duration: 0
							},
							frame: {
								duration: 0
							}
						}
					],
					label: "Pause"
					}
				]
			}],
			sliders: [{
				active: 0,
				steps: null /*slider_steps*/,
				x: 0.1,
				len: 0.9,
				xanchor: "left",
				y: 0,
				yanchor: "top",
				pad: {t: 50, b: 10},
				currentvalue: {
					visible: true,
					prefix: "Year:",
					xanchor: "right",
					font: {
						size: 20,
						color: "#666"
					}
				},
				transition: {
					duration: 300,
					easing: "cubic-in-out"
				}
			}]
		};
		
		plotlyData = [tracePorti];
		
		Plotly.react('myDiv', plotlyData, plotlyLayout);
	});
</script>
</body>
</html>